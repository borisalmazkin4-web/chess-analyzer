# ============================================
# –®–ê–•–ú–ê–¢–ù–´–ô –ê–ù–ê–õ–ò–ó–ê–¢–û–† - –®–ê–ì 1
# –ü–æ–∏—Å–∫ —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–∏ –Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
# ============================================

import cv2
import numpy as np
import os

print("=" * 50)
print("–®–ê–ì 1: –ü–û–ò–°–ö –®–ê–•–ú–ê–¢–ù–û–ô –î–û–°–ö–ò")
print("=" * 50)
print()

# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ñ–æ—Ç–æ
photo_name = "chess_board.jpg"
if not os.path.exists(photo_name):
    print(f"‚ùå –§–∞–π–ª '{photo_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–∞–ø–∫–µ!")
    print()
    print("–ß—Ç–æ –¥–µ–ª–∞—Ç—å:")
    print("1. –°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ —à–∞—Ö–º–∞—Ç–Ω—É—é –¥–æ—Å–∫—É —Å–≤–µ—Ä—Ö—É")
    print("2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–æ—Ç–æ –≤ –ø–∞–ø–∫–µ —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π")
    print("3. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –≤ 'chess_board.jpg'")
    print()
    print("–°–µ–π—á–∞—Å –≤ –ø–∞–ø–∫–µ –µ—Å—Ç—å —Ñ–∞–π–ª—ã:")
    for file in os.listdir("."):
        if file.endswith((".jpg", ".png", ".jpeg")):
            print(f"   - {file}")
    print()
    input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
    exit()

# 2. –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ
print(f"üì∏ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ: {photo_name}")
image = cv2.imread(photo_name)
print(f"‚úÖ –†–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ: {image.shape[1]} x {image.shape[0]} –ø–∏–∫—Å–µ–ª–µ–π")
print()

# 3. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ
cv2.imshow("1. –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ", image)
cv2.waitKey(1000)  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º 1 —Å–µ–∫—É–Ω–¥—É
cv2.destroyAllWindows()

# 4. –î–µ–ª–∞–µ–º —á—ë—Ä–Ω–æ-–±–µ–ª—É—é –≤–µ—Ä—Å–∏—é (–¥–ª—è –ø–æ–∏—Å–∫–∞ —É–≥–ª–æ–≤)
print("üîÑ –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —á—ë—Ä–Ω–æ-–±–µ–ª–æ–µ...")
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

# 5. –ò—â–µ–º —à–∞—Ö–º–∞—Ç–Ω—É—é –¥–æ—Å–∫—É
print("üîç –ò—â–µ–º —à–∞—Ö–º–∞—Ç–Ω—É—é –¥–æ—Å–∫—É...")
print("   (–∏—â–µ–º 7x7 –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —É–≥–ª–æ–≤)")
found, corners = cv2.findChessboardCorners(gray, (7, 7), None)

if not found:
    print()
    print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —à–∞—Ö–º–∞—Ç–Ω—É—é –¥–æ—Å–∫—É!")
    print()
    print("–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:")
    print("1. üì∑ –î–æ—Å–∫–∞ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∏–¥–Ω–∞")
    print("   ‚Üí –°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ —Ç–∞–∫, —á—Ç–æ–±—ã –≤–∏–¥–Ω–æ –≤—Å–µ 4 —É–≥–ª–∞ –¥–æ—Å–∫–∏")
    print()
    print("2. üí° –ü–ª–æ—Ö–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ")
    print("   ‚Üí –í–∫–ª—é—á–∏—Ç–µ –±–æ–ª—å—à–µ —Å–≤–µ—Ç–∞, –∏–∑–±–µ–≥–∞–π—Ç–µ —Ç–µ–Ω–µ–π")
    print()
    print("3. üìê –§–æ—Ç–æ –ø–æ–¥ —É–≥–ª–æ–º")
    print("   ‚Üí –°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–≥–æ —Å–≤–µ—Ä—Ö—É")
    print()
    print("4. ‚ôüÔ∏è –ù–∞ –¥–æ—Å–∫–µ –º–Ω–æ–≥–æ —Ñ–∏–≥—É—Ä")
    print("   ‚Üí –õ—É—á—à–µ –Ω–∞—á–∞—Ç—å —Å –ü–£–°–¢–û–ô –¥–æ—Å–∫–∏ –∏–ª–∏ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏")
    print()
    print("5. üñºÔ∏è –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–æ–µ —Ñ–æ—Ç–æ")
    print("   ‚Üí –î–æ—Å–∫–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–Ω–∏–º–∞—Ç—å –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –∫–∞–¥—Ä–∞")
    print()
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ç–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
    cv2.putText(image, "–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –¥–æ—Å–∫—É!", (50, 50), 
                cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 0, 255), 2)
    cv2.imshow("–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–∏—Å–∫–æ–º –¥–æ—Å–∫–∏", image)
    cv2.waitKey(3000)
    cv2.destroyAllWindows()
    
else:
    print("‚úÖ –®–∞—Ö–º–∞—Ç–Ω–∞—è –¥–æ—Å–∫–∞ –Ω–∞–π–¥–µ–Ω–∞!")
    print()
    
    # 6. –†–∏—Å—É–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —É–≥–ª—ã
    print("üé® –†–∏—Å—É–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —É–≥–ª—ã –Ω–∞ —Ñ–æ—Ç–æ...")
    cv2.drawChessboardCorners(image, (7, 7), corners, found)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å—å
    cv2.putText(image, "–î–æ—Å–∫–∞ –Ω–∞–π–¥–µ–Ω–∞! 7x7 —É–≥–ª–æ–≤", (50, 50), 
                cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 0), 2)
    
    # 7. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    output_file = "step1_board_found.jpg"
    cv2.imwrite(output_file, image)
    print(f"üíæ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤: {output_file}")
    print()
    
    # 8. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    print("üëÄ –ü–æ–∫–∞–∑—ã–≤–∞—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç:")
    print("   - –ö—Ä–∞—Å–Ω—ã–µ –ª–∏–Ω–∏–∏: –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —É–≥–ª—ã –¥–æ—Å–∫–∏")
    print("   - –ï—Å–ª–∏ —É–≥–ª—ã –Ω–µ —Ç–æ—á–Ω–æ –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è—Ö ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ")
    print("   - –ó–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ —Å —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å")
    print()
    
    cv2.imshow("2. –ù–∞–π–¥–µ–Ω–Ω–∞—è –¥–æ—Å–∫–∞ (–∑–∞–∫—Ä–æ–π—Ç–µ —ç—Ç–æ –æ–∫–Ω–æ)", image)
    cv2.waitKey(0)  # –ñ–¥—ë–º, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä–æ–µ—Ç –æ–∫–Ω–æ
    cv2.destroyAllWindows()
    
    # 9. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ö–µ–º—É —É–≥–ª–æ–≤
    print("üìê –°—Ö–µ–º–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —É–≥–ª–æ–≤:")
    print("   (0,0) - –ª–µ–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —É–≥–æ–ª")
    print("   (6,6) - –ø—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —É–≥–æ–ª")
    print()
    print("‚úÖ –ì–æ—Ç–æ–≤–æ! –î–æ—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞.")
    print("   –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 2.")

print("=" * 50)
input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è...")